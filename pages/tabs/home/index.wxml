<view class="container">
  <!-- 几何渐变背景 -->
  <view class="geometric-background">
    <view class="gradient-circle gradient-circle-1"></view>
    <view class="gradient-circle gradient-circle-2"></view>
    <view class="gradient-circle gradient-circle-3"></view>
    <view class="grid-overlay"></view>
    <view class="gradient-mask"></view>
  </view>

  <!-- 内容层 -->
  <view class="content-layer">
    <!-- Hero 区域 -->
    <view class="hero-section" animation="{{heroAnimation}}" style="opacity: 0; transform: translateY(30rpx);">
      <!-- Logo 图标 -->
      <view class="logo-container" animation="{{logoAnimation}}" style="opacity: 0; transform: translateY(20rpx) scale(0.5);">
        <view class="logo-gradient">
          <image class="logo-brain" src="/images/brain.svg" mode="aspectFit" />
        </view>
      </view>

      <!-- 渐变标题 -->
      <view class="hero-title" animation="{{titleAnimation}}" style="opacity: 0; transform: translateY(30rpx);">
        <text class="title-gradient">小杏仁</text>
      </view>

      <!-- 副标题 -->
      <view class="hero-subtitle">
        <text>想到什么，先放下一颗杏仁。</text>
      </view>

      <view class="hero-description">
        <text>不需要想清楚，\n小杏仁会慢慢帮你理清。</text>
      </view>
    </view>

    <!-- Input Section -->
    <view class="input-card" animation="{{inputAnimation}}" style="opacity: 0; transform: translateY(20rpx);">
      <!-- Input Box -->
      <view class="input-box">
        <textarea
          class="textarea"
          placeholder="{{currentPlaceholder}}"
          placeholder-class="placeholder"
          value="{{inputValue}}"
          bindinput="handleInput"
          auto-height
          maxlength="500"
          disabled="{{status === 'processing'}}"
        />
        <view class="submit-btn {{loading || status === 'processing' ? 'disabled' : ''}}" bindtap="handleSubmit">
           <text class="icon-arrow">↑</text>
        </view>
      </view>
    </view>

    <!-- Status Area -->
    <view class="status-area" wx:if="{{status !== 'idle'}}" animation="{{statusAnimation}}">
      
      <!-- Processing -->
      <block wx:if="{{status === 'processing'}}">
        <view class="status-card">
           <view class="status-header">
             <text class="status-icon">🌱</text>
             <text class="status-title">已放下一颗杏仁</text>
           </view>
           <text class="status-desc">我们在帮你慢慢理解它……</text>
        </view>
      </block>

      <!-- Converted -->
      <block wx:if="{{status === 'converted'}}">
        <view class="status-card">
           <view class="status-header">
             <text class="status-icon">🧠</text>
             <text class="status-title">这颗杏仁更像是一段「记忆」</text>
           </view>
           <text class="status-desc">已经帮你整理好了</text>
           <view class="status-actions">
             <view class="action-btn" bindtap="handleView">查看</view>
             <view class="action-btn" bindtap="handleEditType">修改分类</view>
           </view>
        </view>
      </block>

      <!-- Need Confirm -->
      <block wx:if="{{status === 'need_confirm'}}">
        <view class="status-card">
           <view class="status-header">
             <text class="status-icon">🤔</text>
             <text class="status-title">这颗杏仁更像什么？</text>
           </view>
           <view class="type-grid">
             <view class="type-btn" bindtap="handleConfirmType" data-type="memory">
               <text class="type-icon">🧠</text>
               <text class="type-text">记忆</text>
             </view>
             <view class="type-btn" bindtap="handleConfirmType" data-type="todo">
               <text class="type-icon">📝</text>
               <text class="type-text">待办</text>
             </view>
             <view class="type-btn" bindtap="handleConfirmType" data-type="review">
               <text class="type-icon">📅</text>
               <text class="type-text">复盘</text>
             </view>
             <view class="type-btn" bindtap="handleConfirmType" data-type="goal">
               <text class="type-icon">🎯</text>
               <text class="type-text">目标</text>
             </view>
           </view>
           <text class="status-hint" bindtap="handleReset">也可以先放着，之后再说</text>
        </view>
      </block>

      <!-- Confirmed -->
      <block wx:if="{{status === 'confirmed'}}">
        <view class="status-card status-success">
           <view class="status-header">
             <text class="status-icon">✅</text>
             <text class="status-title">好的，这颗杏仁已经整理完成</text>
           </view>
        </view>
      </block>

    </view>

    <!-- Dashboard Cards -->
    <view class="dashboard">
      <view class="card">
         <text class="count text-cyan">{{dashboard.reviewCount}}</text>
         <text class="label">今日待复习</text>
      </view>
      <view class="card">
         <text class="count text-violet">{{dashboard.taskCount}}</text>
         <text class="label">待办事项</text>
      </view>
    </view>

    <!-- 功能介绍 -->
    <view class="feature-section" animation="{{featureAnimation}}" style="opacity: 0; transform: translateY(20rpx);">
      <view class="feature-card">
        <view class="feature-icon icon-cyan">
          <text>🧠</text>
        </view>
        <view class="feature-title">智能分析</view>
        <view class="feature-description">AI 自动分析你的想法，提供记忆辅助和行动建议</view>
      </view>

      <view class="feature-card">
        <view class="feature-icon icon-violet">
          <text>📅</text>
        </view>
        <view class="feature-title">智能复习</view>
        <view class="feature-description">基于记忆曲线，在最佳时间提醒复习重要内容</view>
      </view>

      <view class="feature-card">
        <view class="feature-icon icon-green">
          <text>→</text>
        </view>
        <view class="feature-title">行动转化</view>
        <view class="feature-description">将想法转化为具体任务，AI 协助制定执行计划</view>
      </view>
    </view>
  </view>
</view>
